language: cpp
os:
  - linux

sudo: required
dist: trusty
notifications: 
  email: false

git:
  submodules: false
  depth: 1

services: 
  - docker

matrix:
  include:
    - os: linux
      before_install: 
        - "sudo docker pull onnc/ubuntu-14.04-llvm"
        - "sudo docker create --privileged=true -t --name container --volume ${TRAVIS_BUILD_DIR}:/home/skymizer onnc/ubuntu-14.04-llvm"
        - "sudo docker start container"

      script: 
        - sudo docker exec -t container /bin/bash -c "ls ~"
        - sudo docker exec -t container /bin/bash -c "sudo mkdir ~/build"
        - sudo docker exec -t container /bin/bash -c "cd ~/build && sudo cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=../install .."
        - sudo docker exec -t container /bin/bash -c "cd ~/build && sudo make -j12 install"